### 蜂窝移动通信网
#### 蜂窝无线通信技术简介
+ 蜂窝移动通信又称为`小区制移动通信`，这种通信的特点是`把整个的网络服务区划分为许多小区`，每个小区设置一个`基站`，负责本小区各个移动站的联络和控制，移动站的发送或接收都必须经过基站进行收发；`2G：GSM系统；2.5G：GPRS、EDGE；3G：提供移动宽带多媒体业务`；
![image](https://github.com/ningbaoqi/ComputerNetWork/blob/master/gif/pic-258.jpg) 
+ 采用蜂窝形状结构的小区的好处是可以最大限度的进行频率复用，频率复用是指在相隔一定距离的不同小区可以采用相同的频率而不会相互干扰；

|部分|说明|
|------|------|
|基站收发信机|每个基站都有一个，它把移动站发送来的信号转发给基站控制器BSC|
|基站控制器BSC|控制一组基站，负责管理无线小区以及无线信道|
|移动交换中心MSC|基站通过BSC连接到移动交换中心MSC，MSC是整个GMS网络的核心，它控制所有BSC的业务，提供交换功能，处理所控制区域内移动站的信令，处理移动站的位置更新，一个MSC可连接多个BSC|
|SGSN|如果移动站要接入到因特网，BSC就把移动站发来的IP数据报转发到SGSN；SGSN主要完成IP数据报的转发、移动性管理、会话管理、逻辑链路管理、鉴别和加密、话单产生和输出等功能；SGSN还要和网络交换中心MSC进行通信，以便完成用户的鉴别、通信和切换等功能，GGSC即网关GPRS支持结点，具有网络接入控制功能，因此又称为GPRS路由器,它选择哪些分组可以进入GPRS网络，以保证GPRS网络的安全|

### 移动IP
+ `移动IP`又称为`移动IP协议`，这种技术允许计算机移动到外地时，仍然保留其原来的IP地址；`移动IP`的基本概念：一个移动站A必须有一个原始地址即`永久地址`或`归属地址`，移动站原始连接到的网络叫做`归属网络`，永久地址和归属网络的关联是不会改变的；
![image](https://github.com/ningbaoqi/ComputerNetWork/blob/master/gif/pic-259.jpg) 
+ 移动IP使用了代理，`归属代理`通常就是连接在归属网络上的路由器；然而它作为代理的特定功能则是在应用层完成的，因此，归属代理既是路由器也是主机；当移动站A移动到另一个地点，它所接入的网络称为`被访网络`或`外地网络`，被访网络中使用的代理叫做`外地代理`，它通常是连接在被访网络上的路由器(当然也充当主机)，外地代理的一个任务就是要为移动站A创建一个临时地址，叫做`转交地址`，转交地址的网络号显然必须和被访网络一致；`外地代理`的另一个功能就是及时把移动站A的转交地址通知A的归属代理；

|注意|说明|
|------|------|
|一|转交地址是供移动站、归属代理以及外地代理使用的，各种应用程序都不使用这种转交地址|
|二|转交地址在因特网中并不具有唯一性，也就是说，外地代理可以给好几个移动站指派同样的转交地址，设置把自己的IP地址指派为移动站的转交地址。这样并不会发生混乱，这是因为当外地代理要向连接在被访网络上的移动站发送数据报时，并不会像普通那样使用地址解析协议ARP，而是直接使用这个移动站的MAC地址|

+ 有时移动站本身也充当外地代理，即移动站和外地代理是一个设备，这时的转交地址叫做`同址转交地址`；
#### 例子
+ 一个通信者B要和移动站A进行通信，B并不知道A在什么地方，但B可以使用A的永久地址作为发送的IP数据报中的目的地址；

|过程|
|------|
|B发送给A的数据报被A的归属代理截获了(只有当A离开了归属网络时，归属代理才能截获发给A的数据报)|
|由于归属代理已经知道了A的转交地址，因此归属代理把A发来的数据报进行再封装，新的数据报的目的地址是A现有的转交地址，新封装的数据报发送到被访网络的外地代理|
|被访网络中的外地代理把收到的封装的数据报进行拆封，取出B发送的原始数据报，然后转交给移动站A，这个数据报的目的地址就是A的永久的地址|

+ 为了支持移动性，在网络层应当增加以下的一些新功能：`移动站到外地代理的协议`；`外地代理到归属代理的登记协议`；`归属代理数据报封装协议`；`外地代理拆封协议`；
### 蜂窝移动通信网中对移动用户的路由选择
![image](https://github.com/ningbaoqi/ComputerNetWork/blob/master/gif/pic-260.jpg) 
